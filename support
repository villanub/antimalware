configuration TestLab
{
    param
    (
        [string[]]$NodeName ='Rackspace-DEv1',
        [Parameter()][string]$UserName,
        [Parameter()]$Password
    ) 
 
    #Import the required DSC Resources
    #Import-DscResource -Module xComputerManagement 
 
    Node $NodeName
    {
 
        User LocalAdmin {
            UserName = $UserName
            Description = 'Our new local admin'
            Ensure = 'Present'
            FullName = 'RaxSupport'
            Password = $Password
            PasswordChangeRequired = $false
            PasswordNeverExpires = $true
            #DependsOn = '[xComputer]NewNameAndWorkGroup'
        }

        Group AddToAdmin{
            GroupName='Administrators'
            DependsOn= '[User]LocalAdmin'
            Ensure= 'Present'
            MembersToInclude=$UserName
 
        }
 
    }
}
 
$configData = 'a'
 
$configData = @{
                AllNodes = @(
                              @{
                                 NodeName = 'Rackspace-Dev1';
                                 PSDscAllowPlainTextPassword = $true
                                    }
                    )
               }
 
#See whats needs to be configured
# Get-DscResource User | select -ExpandProperty Properties | select -expand name
 
TestLab -Password (Get-Credential -UserName 'FoxDeploy' -Message 'Enter New Password') -UserName 'FoxDeploy' -ConfigurationData $configData
 
Start-DscConfiguration -ComputerName Rackspace-dev1 -Wait -Force -Verbose -path C:\Scripts\TestLab
